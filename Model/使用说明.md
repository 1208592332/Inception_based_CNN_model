### 模型使用说明

---

#### 0.用途

该工程可用来进行特征提取及分类预测。是一个基于Inception-v3模型的卷积神经网络模型。其基本网络结构是：Inception-v3+一个全连接层，其中：

- Inception-v3模型用来进行特征提取，通过其瓶颈层输出2048长度的特征向量
- 全连接层用来对特征进行分类操作，其输出是目标类别的判断百分比

#### 1.工程结构

该工程包含一个文件夹及两个文件，这些文件(夹)都是必要的：

- bottleneck文件夹：缓存特征提取结果，加快验证及测试时间。
- Classifier.py：代码文件，实现基于Inception-v3模型的迁移学习以提取特征与分类预测。
- tensorflow_inception_graph.pb：训练好的Inception-v3模型及参数

#### 2.如何使用

首先，准备数据集。数据集应该具有这样的结构：

- 主目录

  - 子目录1
    - 图片1
    - 图片2
    - ...
  - 子目录2
  - ...

  其中每个子目录代表将要分类的一个类别，其下放置所有该类别的图片数据。子目录的数目代表了将要分类的数目。

接下来，修改CNN.py文件参数。你需要修改包括两部分的参数，其一为数据路径，包括：

- MODEL_DIR：Inception-v3模型存放的路径地址
- MODEL_FILE：Inception-v3模型文件名称
- CACHE_DIR：缓存特征向量的文件夹地址，也就是工程结构下的bottleneck文件夹地址
- INPUT_DATA：数据集的主目录地址

其二为模型训练的参数，这些参数可以先沿用默认值，包括：

- 测试集和验证集百分比：测试集用来在训练时测试训练的正确率，测试集用来测试模型最终的正确率，这里默认取为10，代表数据集的10%
- STEPS：训练次数
- BATCH：每次训练给模型传输的数据量
- 学习率：包括基础学习率(BASE_LEARNING_RATE，即开始时的学习率)，最低学习率（MIN_LEARNING_RATE 最终衰减的极限）

完成以上两个过程后，运行Classifier.py文件即可，运行过程中会有一个线程单独显示当前的训练正确率。

#### 3.获取帮助

你可通过以下方式联系我：

- 微信：18217235290

- Email：yooongchun@foxmail.com

